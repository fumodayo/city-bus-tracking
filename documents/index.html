<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.css' rel='stylesheet' />
  <title>Document</title>
</head>

<body>
  <div>Hello</div>
</body>
<script>
  /**
   * Get data in txt file
   * */

  //   let str = `
  // 1. Bến xe buýt Đại học Việt Hàn,
  // 15.974022216394241, 108.25452232447924,
  // 2. Tổ 24 Đông Trà Trần Đại Nghĩa,
  // 15.982128086847377, 108.25601409264209,
  // 3. E144 Trần Đại Nghĩa,
  // 15.982134521508199, 108.25601555517423,
  // 4. Sân tập lái ô tô đường Trần Đại Nghĩa,
  // 15.989020788561273, 108.25755685860983,
  // 6. 527 Lê Văn Hiến,
  // 16.00160530322441, 108.2598358826321,
  // 7. 509 Lê Văn Hiến,
  // 16.002526668270605, 108.25980398561187,
  // 8. 415 Lê Văn Hiến,
  // 16.006366877017168, 108.25929677344821,
  // 9. 307 Lê Văn Hiến,
  // 16.010303979794397, 108.25730216701777,
  // 10. 127 Lê Văn Hiến,
  // 16.022860356737205, 108.25104161718339,
  // 11. Doanh trại quân đội đường Lê Văn Hiến,
  // 16.033630924778116, 108.24558233887281,
  // 12. 61 Lê Văn Hiến,
  // 16.03363255173983, 108.2455846530745,
  // 13. 175 Ngũ Hành Sơn,
  // 16.039267980391422, 108.24269273776413,
  // 14. 133 Ngũ Hành Sơn,
  // 16.042832723761766, 108.24081970838753,
  // 16. Đại học Kinh Tế,
  // 16.047831351519566, 108.23864826341214,
  // 17. 29 Ngũ Hành Sơn,
  // 16.051795385002077, 108.2374687610848,
  // 18. 1093 Ngô Quyền,
  // 16.056546596467292, 108.23596967118698,
  // 19. 1041 Ngô Quyền,
  // 16.059080611091073, 108.23521413301363,
  // 20. Cầu Rồng (số lẽ đường Võ Văn Kiệt),
  // 16.061547643585026, 108.23337367661787,
  // 21. Bến chợ Hàn,
  // 16.068023245407986, 108.22505952774726,
  // 22. Đối diện 59 Hùng Vương,
  // 16.06851859096782, 108.21974747888261,
  // 23. 192 Hùng Vương,
  // 16.068016981544414, 108.21741182319265,
  // 24. Chợ Cồn,
  // 16.06747745758302, 108.21463722946298,
  // 25. 10 Lý Thái Tổ,
  // 16.066550421874894, 108.20997834512136,
  // 26. 130 Lý Thái Tổ,
  // 16.066230361801473, 108.20739171149656,
  // 27. Siêu thị Nguyễn Kim,
  // 16.066440031526586, 108.20344655109668,
  // 28. 130 Điện Biên Phủ,
  // 16.065790588557025, 108.19934642887499,
  // 29. 336 Dien Bien Phu,
  // 16.066008524369792, 108.19298386072211,
  // 30. 416 Điện Biên Phủ,
  // 16.06603870641431, 108.18939272362793,
  // 31. 570 Điện Biên Phủ,
  // 16.06564047162372, 108.18418540896684,
  // 32. 128 Tôn Đức Thắng,
  // 16.059094783578992, 108.17443186308077,
  // 33. 210 Tôn Đức Thắng,
  // 16.056918657023267, 108.17140503578477,
  // 34. 294 Tôn Đức Thắng,
  // 16.056472157983634, 108.16828799015995,
  // 35. 422 Tôn Đức Thắng,
  // 16.0604808300658, 108.16259227747018,
  // 36. 552 Tôn Đức Thắng,
  // 16.06296035431722, 108.1588978340965,
  // 37. 640 Tôn Đức Thắng,
  // 16.064640588035267, 108.15641694044808,
  // 38. 758 Tôn Đức Thắng,
  // 16.06686431208779, 108.15311494705684,
  // 39. 806 Tôn Đức Thắng,
  // 16.06856784996234, 108.15191053145458,
  // 40. 50 Nguyễn Lương Bằng,
  // 16.072703094968304, 108.1502324692913,
  // 41. 138 Nguyễn Lương,
  // 16.076877264440945, 108.14853636339204,
  // 42. 234 Nguyễn Lương Bằng,
  // 16.08073493405139, 108.14693498683692,
  // 43. 290 Nguyễn Lương Bằng,
  // 16.082993153100066, 108.14601475919088,
  // 44. 396 Nguyễn Lương Bằng,
  // 16.087288466292577, 108.14414723834219,
  // 45. 438 Nguyễn Lương Bằng,
  // 16.090352775241932, 108.14296086642372,
  // 46. 546 Nguyễn Lương Bằng,
  // 16.100182516489177, 108.1353780100409,
  // 47. 636 Nguyễn Lương Bằng,
  // 16.105166546800323, 108.13289700411802,
  // 48. 788 Nguyễn Lương Bằng,
  // 16.110726592257993, 108.12971616629946,
  // 49. 922 Nguyễn Lương Bằng,
  // 16.114912963638453, 108.12690586319908,
  // 50. 52 Nguyễn Văn Cừ,
  // 16.125726521072025, 108.11990593830097,
  // 51. 274 Nguyễn Văn Cừ,
  // 16.13537674376428, 108.11980751312127
  //   `
  //   str = str.replace(/(\r\n|\n|\r)/gm, "").trim()
  //   let arr2str = str.split(',');

  //   let b = []
  //   let c = []
  //   const getArr = () => {
  //     return fetch(
  //       `https://api.mapbox.com/directions/v5/mapbox/driving/${arr2str[2]},${arr2str[1]};${arr2str[5]},${arr2str[4]}?steps=true&geometries=geojson&access_token=pk.eyJ1IjoidGhhaXJ5byIsImEiOiJjbDdjb2ZnY3QxM2F6M3FtaW9zMDFpNWkzIn0.tPFJvhG-HJ0TdmJGolVjHA`,
  //       { method: 'GET' }
  //     ).then(res => res.json())
  //       .then(function (data) {
  //         let route = data.routes[0].geometry.coordinates;
  //         c = route
  //         b = [...b, c]
  //         console.log(b)
  //       })
  //   }

  //   setInterval(() => {
  //     if (arr2str.length > 3) {
  //       // getArr()
  //       arr2str.splice(0, 3)
  //     }
  //   }, 3000)

  let arr = [
    {
      id: 16738996829,
      name: 'Cảng Sông Hàn',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.22373539714997',
        lat: '16.082622488559792'
      }
    },
    {
      id: 96534531693,
      name: '20 Đống Đa',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.22080749112735',
        lat: '16.082442262480814'
      }
    },
    {
      id: 66874241697,
      name: '104-106 Đống Đa',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21866622578328',
        lat: '16.080846681098016'
      }
    },
    {
      id: 90091923291,
      name: '240 Đống Đa',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21634214523567',
        lat: '16.07735109250178'
      }
    },
    {
      id: 69356868879,
      name: '322 Đống Đa',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21486006875192',
        lat: '16.075146363593603'
      }
    },
    {
      id: 30866566611,
      name: 'Chợ Tam Giác',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21350920202813',
        lat: '16.07304754472222'
      }
    },
    {
      id: 43954804335,
      name: 'Siêu thị BigC',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21414968927846',
        lat: '16.06671067943846'
      }
    },
    {
      id: 24224554343,
      name: '522-524 Ông Ích Khiêm',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21524217769469',
        lat: '16.063914638901146'
      }
    },
    {
      id: 85012725359,
      name: '618 Ông Ích Khiêm',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21659304984732',
        lat: '16.06120650364192'
      }
    },
    {
      id: 11211852261,
      name: '11-15 Nguyễn Văn Linh',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21606974429214',
        lat: '16.060495515557168'
      }
    },
    {
      id: 6201917869,
      name: 'Đối Diện Chùa Phước Ninh',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21770742471998',
        lat: '16.060701218906388'
      }
    },
    {
      id: 98459035487,
      name: 'Công viên Apec',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.22297389483775',
        lat: '16.05881971533636'
      }
    },
    {
      id: 40466335018,
      name: '152A-154 Đường 2/9',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.2220825286856',
        lat: '16.051422409087756'
      }
    },
    {
      id: 62964668698,
      name: '214-216 Đường 2/9',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.22244333000998',
        lat: '16.047377717355666'
      }
    },
    {
      id: 40675849120,
      name: '264-266 Nui Thanh 48',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.22145177653864',
        lat: '16.0431885951292'
      }
    },
    {
      id: 75222735090,
      name: 'Nút giao Lê Thanh Nghị - đường 30/4',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21842312380464',
        lat: '16.04057989123785'
      }
    },
    {
      id: 26802440723,
      name: 'Trước Công Ty Kiểm Toán & Kế toán AAC',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.21473525105212',
        lat: '16.040135250027227'
      }
    },
    {
      id: 59621625940,
      name: '300-302 Nguyễn Hữu Thọ',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.20973178755769',
        lat: '16.03626088661962'
      }
    },
    {
      id: 21936158344,
      name: '432-434 Nguyễn Hữu Thọ',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.2088633935457',
        lat: '16.03294622570042'
      }
    },
    {
      id: 51083822769,
      name: 'Viettrolimex-Nguyễn Hữu Thọ',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.20847814481236',
        lat: '16.03044399142489'
      }
    },
    {
      id: 52047590015,
      name: '40-42 Lê Đại Hành',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.20750088310731',
        lat: '16.02432236373561'
      }
    },
    {
      id: 34109196786,
      name: 'Ban nghĩa trang TP',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.20432685227635',
        lat: '16.02343559925508'
      }
    },
    {
      id: 68582728863,
      name: 'Dệt may Hòa Thọ',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.20320561865236',
        lat: '16.02006834748365'
      }
    },
    {
      id: 42426829559,
      name: '307-309 đường CMT8',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.20425967895206',
        lat: '16.016929092832047'
      }
    },
    {
      id: 61531415022,
      name: '492 đường CMT8',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.1972225081628',
        lat: '16.01403691032848'
      }
    },
    {
      id: 18523528372,
      name: 'Trước Trung Tâm GDTX Số 3',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.19116550241041',
        lat: '16.004826844508724'
      }
    },
    {
      id: 52274489356,
      name: 'Ngã ba DT605 giao Quốc lộ 1A',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.1919671582678',
        lat: '15.993832228125905'
      }
    },
    {
      id: 74348139509,
      name: 'Đối Diện Trụ Điện 238',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.19088323683629',
        lat: '15.992601168621881'
      }
    },
    {
      id: 97018882414,
      name: 'Trường tiểu học Số 2 Hòa Tiến',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.18147451549397',
        lat: '15.968812373973853'
      }
    },
    {
      id: 93856378022,
      name: 'Gần kiệt 12 thôn Lệ Sơn Bắc',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.17954650785964',
        lat: '15.962571010356013'
      }
    },
    {
      id: 65595071565,
      name: 'Gần nhà thuốc số 1 thôn Lệ Sơn Bắc',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.17981410434453',
        lat: '15.959531241800514'
      }
    },
    {
      id: 916017829,
      name: 'Hòa Tiến (Nghĩa trang xã Hòa Tiến)',
      nameLocationBusRoute: 'R4A',
      location: {
        lng: '108.17859432663842',
        lat: '15.953196751501668'
      }
    }
  ]


  const arr2 = arr.map(i => {
    let ag = i.location.lng
    let bg = i.location.lat
    return [ag, bg]
  })

  let b = []
  let c = []
  const getArr = () => {
    return fetch(
      `https://api.mapbox.com/directions/v5/mapbox/driving/${arr2[0][0]},${arr2[0][1]};${arr2[1][0]},${arr2[1][1]}?steps=true&geometries=geojson&access_token=pk.eyJ1IjoidGhhaXJ5byIsImEiOiJjbDdjb2ZnY3QxM2F6M3FtaW9zMDFpNWkzIn0.tPFJvhG-HJ0TdmJGolVjHA`,
      { method: 'GET' }
    ).then(res => res.json())
      .then(function (data) {
        let route = data.routes[0].geometry.coordinates;
        c = route
        b = [...b, c]
        console.log(b.flat(1))
      })
  }

  setInterval(() => {
    if (arr2.length >= 2) {
      // getArr();
      arr2.shift();
    }
  }, 1000)


  let str = `
  Cảng Sông Hàn,16.082622488559792, 108.22373539714997,
20 Đống Đa,16.082442262480814, 108.22080749112735,
104-106 Đống Đa,16.080846681098016, 108.21866622578328,
240 Đống Đa,16.07735109250178, 108.21634214523567,
322 Đống Đa,16.075146363593603, 108.21486006875192,
Chợ Tam Giác,16.07304754472222, 108.21350920202813,
Siêu thị BigC,16.06671067943846, 108.21414968927846,
522-524 Ông Ích Khiêm,16.063914638901146, 108.21524217769469,
618 Ông Ích Khiêm,16.06120650364192, 108.21659304984732,
Đối Diện Chùa Phước Ninh,16.060701218906388, 108.21770742471998,
11-15 Nguyễn Văn Linh,16.060495515557168, 108.21606974429214,
Công viên Apec,16.05881971533636, 108.22297389483775,
152A-154 Đường 2/9,16.051422409087756, 108.2220825286856,
214-216 Đường 2/9,16.047377717355666, 108.22244333000998,
264-266 Nui Thanh 48,16.0431885951292, 108.22145177653864,
Nút giao Lê Thanh Nghị - đường 30/4,16.04057989123785, 108.21842312380464,
Trước Công Ty Kiểm Toán & Kế toán AAC,16.040135250027227, 108.21473525105212,
300-302 Nguyễn Hữu Thọ,16.03626088661962, 108.20973178755769,
432-434 Nguyễn Hữu Thọ,16.03294622570042, 108.2088633935457,
Viettrolimex-Nguyễn Hữu Thọ,16.03044399142489, 108.20847814481236,
40-42 Lê Đại Hành,16.02432236373561, 108.20750088310731,
Ban nghĩa trang TP,16.02343559925508, 108.20432685227635,
Dệt may Hòa Thọ,16.02006834748365, 108.20320561865236,
307-309 đường CMT8,16.016929092832047, 108.20425967895206,
492 đường CMT8,16.01403691032848, 108.1972225081628,
Trước Trung Tâm GDTX Số 3,16.004826844508724, 108.19116550241041,
Ngã ba DT605 giao Quốc lộ 1A,15.993832228125905, 108.1919671582678,
Đối Diện Trụ Điện 238,15.992601168621881, 108.19088323683629,
Trường tiểu học Số 2 Hòa Tiến,15.968812373973853, 108.18147451549397,
Gần kiệt 12 thôn Lệ Sơn Bắc,15.962571010356013, 108.17954650785964,
Gần nhà thuốc số 1 thôn Lệ Sơn Bắc,15.959531241800514, 108.17981410434453,
Hòa Tiến (Nghĩa trang xã Hòa Tiến),15.953196751501668, 108.17859432663842`

  // str = str.replace(/(\r\n|\n|\r)/gm, "").trim()
  // let arr = str.split(',')
  // let arr2 = arr.map(i => i.trim())
  // let b = [];
  // let c = [];

  // const getArr = () => {
  //   const a = {
  //     id: Math.floor(Math.random() * 100000000000),
  //     name: arr2[0],
  //     nameLocationBusRoute: 'R4A',
  //     location: {
  //       lng: arr2[2],
  //       lat: arr2[1]
  //     }
  //   }
  //   return a
  // }

  // setInterval(() => {
  //   if (arr2.length >= 3) {
  //     getArr()
  //     c = getArr()
  //     b = [...b, c]
  //     console.log(b)
  //     arr2.splice(0, 3)
  //   }
  // })

  // const str = `336 Điện Biên Phủ,thanh pho Đà Nẵng, Vietnam`
  // let b = []
  // let c = []
  // const getArr = () => {
  //   return fetch(
  //     `https://api.mapbox.com/geocoding/v5/mapbox.places/${str}.json?worldview=cn&access_token=pk.eyJ1IjoidGhhaXJ5byIsImEiOiJjbDc4OTMzNzkwN2ZzM3ZueXE0NWdyNHB0In0.G_TZ_zbzQ8T7512A44nK9g`
  //   )
  //     .then(res =>{
  //       console.log(res)
  //       return res.json()
  //     }
  //     )
  //     .then(results => {
  //       b.push({
  //         ...b,
  //         longitude: results.features[0].center[0],
  //         latitude: results.features[0].center[1]
  //       })
  //     })
  // }
  // console.log('1', b)

  // getArr()

</script>

</html>